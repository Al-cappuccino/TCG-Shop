@using TCGshopTestEnvironment.ViewModels
@model List<ProductsShopCartViewModel>
@*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Dynatable/0.3.1/jquery.dynatable.css">
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/Dynatable/0.3.1/jquery.dynatable.js' defer='defer'></script>*@

@inject SignInManager<UserAccount> SignInManager
@inject UserManager<UserAccount> UserManager

@*check if user is logged in*@



@if (SignInManager.IsSignedIn(User))
{
<div id="productsTable">
    <table class="table table-condensed" id="productsIndexTable">
        <thead>
        <tr>
            <th>Image</th>
            <th>Name</th>
            <th>Grade</th>
            <th>Price</th>
            <th>Amount</th>
            <th>Total Price</th>
        </tr>
        </thead>
        <tbody>
            @foreach (var asset in @Model)
            {
            <tr class="assetRow" id="row-@asset.CartID">
                <td class="">
                    <img src="@(Startup.storagePath + asset.ImageUrl+ ".png")" class="imageCell" />
                </td>
                <td class="">@asset.Name</td>
                <td class="">@asset.Grade</td>
                <td class="">€@asset.Price</td>
                <td class="" id="item-count-@asset.CartID">@asset.Amount</td>
                <td class="" id="item-total-@asset.CartID">@asset.TotalPrice</td>
                <td class="">
                    <a href="#" class="RemoveLink"
                       data-id='["@asset.CartID","@asset.Price"]'>
                        Remove
                        from cart
                    </a>
                </td>
            </tr>
            }
        </tbody>
    </table>
</div>
}

//load shoppingcart products from the localstorage using ajax if user is not logged in.
else
{
    <div id="ShoppingCart"></div>

    <table id="my-ajax-table" class="table table-condensed">
        <thead>
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>ImageUrl</th>
            <th>Price</th>
            <th>Grade</th>
            <th>Count</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
}


<script type='text/javascript' src='/js/ShoppingCart.js' defer='defer'></script>*