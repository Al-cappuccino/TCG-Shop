@using TCGshopTestEnvironment.ViewModels
@model List<ProductsShopCartViewModel>
@*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Dynatable/0.3.1/jquery.dynatable.css">
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/Dynatable/0.3.1/jquery.dynatable.js' defer='defer'></script>*@

@inject SignInManager<UserAccount> SignInManager
@inject UserManager<UserAccount> UserManager

@*check if user is logged in*@



@if (SignInManager.IsSignedIn(User))
{
<div id="productsTable">
    <table class="table table-condensed" id="productsIndexTable">
        <thead>
        <tr>
            <th>Image</th>
            <th>Name</th>
            <th>Grade</th>
            <th>Price</th>
            <th>Amount</th>
            <th>Total Price</th>
        </tr>
        </thead>
        <tbody>
            @foreach (var asset in @Model)
            {
            <tr class="assetRow" id="row-@asset.CartID">
                <td class="">
                    <img src="@(Startup.storagePath + asset.ImageUrl+ ".png")" class="imageCell" />
                </td>
                <td class="">@asset.Name</td>
                <td class="">@asset.Grade</td>
                <td class="">€@asset.Price</td>
                <td class="" id="item-count-@asset.CartID">@asset.Amount</td>
                <td class="" id="item-total-@asset.CartID">@asset.TotalPrice</td>
                <td class="">
                    <a href="#" class="RemoveLink"
                       data-id='["@asset.CartID","@asset.Price"]'>
                        Remove
                        from cart
                    </a>
                </td>
            </tr>
            }
        </tbody>
    </table>
</div>
}

//load shoppingcart products from the localstorage using ajax if user is not logged in.
else
{
<div class="container">
    <div class="row">
        <div class="col-md-8">
            <div id="ShoppingCart"></div>
            <table id="my-ajax-table" class="">
                <h2 style="font-weight: 800;color:darkgrey;">Shopping Cart</h2>
                <thead>
                    <tr></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="col-md-4">
            <div id="ShoppingCart">
                <h2 style="font-weight: 800;color:darkgrey;padding-bottom:20px;">Share your list</h2>
                <hr class="border-bottom" />
                <i class="fa fa-facebook-square"></i>
            </div>
        </div>
    </div>
</div>
}



<script type='text/javascript' src='/js/ShoppingCart.js' defer='defer'></script>*